# ドメインモデルのリファクタリング

リファクタリングの結果、`Customer`クラスから`Point`, `Price`, `Rentals` クラスにドメインロジックが移動されたので、  
`CustomerTest`クラスはなくなり,
 - `NewReleasePointTest`
 - `ChildrenPriceTest`, `NewReleasePriceTest`, `RegularPrice` 
 - `RentalsTest`

 - のシンプルなテストに変わります.

```java
class NewReleasePointTest {
    @Test
    void 新作を1日レンタルするポイント() {
        NewReleasePoint sut = new NewReleasePoint();
        assertEquals(1, sut.frequentRenterPoints(1));
    }

    @Test
    void 新作を2日レンタルするポイント() {
        NewReleasePoint sut = new NewReleasePoint();
        assertEquals(2, sut.frequentRenterPoints(2));
    }
}
```

```java
class RegularPriceTest {

    @Test
    void 旧作を2日レンタルする料金() {
        RegularPrice sut = new RegularPrice();
        assertEquals(2, sut.charge(2));
    }

    @Test
    void 旧作を3日レンタルする料金() {
        RegularPrice sut = new RegularPrice();
        assertEquals(3.5, sut.charge(3));
    }
}
```

```java 
package video.domain.rental;

import org.junit.jupiter.api.Test;
import video.domain.movie.Movie;
import video.domain.movie.MovieType;

import static org.junit.jupiter.api.Assertions.*;

class RentalsTest {

    Movie 子供用作品_となりのトトロ = new Movie("となりのトトロ", MovieType.CHILDREN);
    Movie 旧作_トップガン = new Movie("トップガン", MovieType.REGULAR);
    Movie 新作_君たちはどう生きるか = new Movie("君たちはどう生きるか", MovieType.NEW_RELEASE);

    @Test
    void 新作と旧作と子供用ビデオのレンタルのポイント() {
        Rentals rentals = new Rentals();
        rentals.add(new Rental(子供用作品_となりのトトロ, 6));
        rentals.add(new Rental(旧作_トップガン, 7));
        rentals.add(new Rental(新作_君たちはどう生きるか, 7));

        double frequentRenterPoints = rentals.frequentRenterPoints();

        assertEquals(4, frequentRenterPoints);

    }

    @Test
    void 新作と旧作と子供用ビデオのレンタルの料金() {
        Rentals rentals = new Rentals();
        rentals.add(new Rental(子供用作品_となりのトトロ, 6));
        rentals.add(new Rental(旧作_トップガン, 7));
        rentals.add(new Rental(新作_君たちはどう生きるか, 7));

        double totalAmount = rentals.totalAmount();

        assertEquals(36.5, totalAmount);
    }
}
```