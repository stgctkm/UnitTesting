過度に複雑なコードのテストコードは複雑で理解しにくいコードになりがちです。
テストをわかりやすくするためにはプロダクションコードをリファクタリングする必要があります。

1. 過度に複雑なコードをドメインモデル/アルゴリズムとコントローラーに分割する
2. ドメインモデルをリファクタリングする
3. 

TODO 7章の要約も書く。